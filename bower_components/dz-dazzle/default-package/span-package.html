<link rel="import" href="../../polymer/polymer-element.html">
<link rel="import" href="../../vaadin-text-field/vaadin-text-area.html" />
<link rel="import" href="../../vaadin-icons/vaadin-icons.html" />
<link rel="import" href="../dz-content-box.html" />
<script>

	class spanPackage {
		constructor(elm){
			// super();
			console.log('Custom a',elm);
			elm.label = '段落文字';
			elm.menu = [{
                        'text': '編輯',
                        'event': 'edit'
                    }];

			elm.menu.forEach(item=>{
				item.source = elm;
			});
			elm.selected = function(url){
				elm.changeBg(url);
			}

			elm.changeBg = function(url){
				elm.style.backgroundImage = 'url('+url+')';
			}

			elm.edit = function(){

				console.log('Render');
				elm.editor();

				// var htmlText = elm.innerHTML;

				// var htmlArray = $.parseHTML(htmlText);

				// var isHtml = htmlArray.filter(function(e){ return e instanceof HTMLElement;}).length;

				// console.log('Is HTML',htmlText,isHtml);

				// if (!isHtml){
				// 	let rect = elm.getBoundingClientRect();
				// 	console.log('Rect',rect);
				// 	let width = rect.width;
				// 	let height = rect.height;
				// 	let dzPopup = window.document.createElement('dz-content-box');
				// 	dzPopup.value = elm.innerHTML;
				// 	dzPopup.source = elm;
				// 	// dzPopup.innerHTML = elm.innerHTML;
				// 	width +=100;
				// 	height +=200;
				// 	Polymer.componentPopup(dzPopup,width+'px',height+'px');
				// } else {
				// 	let html = elm.outerHTML;
				// 	let dzEditor = document.createElement('dz-editor');
				// 	dzEditor.innerHTML = html;
				// 	elm.outerHTML = dzEditor.outerHTML;
				// }

					

			}

			elm.dataUpdate = function(){
				let field;
				if (!elm.hasAttribute('dz-data'))
					return;
				else
					field = elm.getAttribute('dz-data');			
				if (!elm.dataModel)
					return;
				elm.addPropertyChange('innerHTML',elm.dataModel[field]);
			}

			// elm.dataUpdate();
		}
	}


  

</script>
