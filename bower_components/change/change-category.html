<link href="../polymer/polymer.html" rel="import">
<link href="../dz-menu/css/style.html" rel="import" />
<link rel="import" href="../vaadin-select/vaadin-select.html">

<dom-module id="change-category">
    <template>
        <style>
            :host{
                --lumo-contrast-10pct: hsla(0, 0%, 100%, 0);
                --lumo-body-text-color:#808080;
            }
        </style>
        <vaadin-select id="cat1" placeholder="選擇分類"></vaadin-select>
    </template>
</dom-module>
<script>
    (function () {
        Polymer({
            is: 'change-category',
            properties: {},
            created: function () {
                console.log('Created');
            },
            ready: function() {
             
                this.valueArray = [""];
                let that = this;
                let shadow = this.shadowRoot;
                customElements.whenDefined('vaadin-select').then(function() {
                    const choice = [{
                        id: '車與地產',
                        name: '車與地產'
                    }, {
                        id: '潮流生活',
                        name: '潮流生活'
                    }, {
                        id: '家居生活',
                        name: '家居生活'
                    }, {
                        id: '興趣與遊戲',
                        name: '興趣與遊戲'
                    }, {
                        id: '工作與服務',
                        name: '工作與服務'
                    }, {
                        id: '其他服務',
                        name: '其他服務'
                    }];


                    shadow.querySelector('#cat1').renderer = function(root) {
                        // Check if there is a list-box generated with the previous renderer call to update its content instead of recreation
                        if (root.firstChild) {
                            return;
                        }
                        // Create the <vaadin-list-box>
                        const listBox = document.createElement('vaadin-list-box');
                        choice.forEach(function(item) {
                            const vaadinItem = document.createElement('vaadin-item');
                            vaadinItem.textContent = item.name;
                            listBox.appendChild(vaadinItem);
                            vaadinItem.setAttribute('value', item.id);
                            vaadinItem.addEventListener('click',e=>{
                                console.log('Cate E',e, shadow.querySelector('#cat1').value);
                            });
                        });
                        // update the content
                        root.appendChild(listBox);
                    };
                    this.selection = shadow.querySelector('#cat1');
                    this.selection.addEventListener('change',e=>{
                            let value = shadow.querySelector('#cat1').value;
                            Polymer.dzFire('select-category',{'detail':{'category':value}});
                    });
                });




            },
        });
    })();
</script>