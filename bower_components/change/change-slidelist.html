<link rel="import" href="https://d25k6mzsu7mq5l.cloudfront.net/bower_components/polymer/polymer.html">

<link rel="import" href="https://d25k6mzsu7mq5l.cloudfront.net/bower_components/dz-dazzle/dz-block.html">
<link rel="import" href="./change-in-item.html">
<link rel="import" href="./change-category.html">
<link rel="import" href="./change-district.html">
<link rel="import" href="./change-range.html">
<!-- <link rel="import" href="change-like2.html"> -->
<link rel="import" href="https://d25k6mzsu7mq5l.cloudfront.net/bower_components/vaadin-accordion/vaadin-accordion.html">
<dom-module id="change-slidelist">

    <template>

        <style>
            *{
                font-family: sans-serif,微軟正黑體;
            }
         

            change-in-item{
                -webkit-box-shadow: 1px 0px 8px 0px rgba(50, 49, 56, 0.2);
                -moz-box-shadow: 1px 0px 8px 0px rgba(50, 49, 56, 0.2);
                box-shadow: 1px 0px 8px 0px rgba(50, 49, 56, 0.2);
            }
            .catbutton{
                background-color: lightgrey;
                text-align: center;
                padding-left: 13px;
                padding-right: 13px;
                border: none;
                width: auto;
                height: 30px;
                border-radius: 15px;

            }
            a:link,
            a:visited {
                text-decoration: none;
                color: black;
            }

            a:hover {
                text-decoration: none;

            }
            #miniimg{
                width:30px;
                height:30px;
            }

            /* .address td{
                position:relative;
            }
            .address #miniimg{
                position:absolute;
                top:10px;
            } */
            .address{
                display: grid;
                width: 97%;
                height:100%;
                grid-row-gap: 0px;
				padding:5px;
				grid-column-gap: 0px;
                grid-row-gap: 0px;
				grid-template-columns: 2fr 8fr;
                background-color: white;
            }
            .shouldblock2{
                display: inline;
            }
            .leftele{
                float: left;
                color: black;
                margin-left: 8px;
                border:none
            }
            .leftele2{
                float:left;
                border: none;
         
                
            } 
            .rightele{
                float: left;
            }
            .rightele2{
                float:right;
            }
            .shouldblock{
                display: flow-root;
            }

            #leftele{
                float: left;
                width: 18%;
                min-width: 220px;
                margin-top: 50px;
                margin-right:30px;
            }

            #rightele{
                width:70%;

            }


            body{
                background-color: wheat;
            }
             #containall{
                background-color: wheat;
                width: 100%;
            }

            .valuebar1 {
                padding-top: 8px;
                padding-left: 15px;
                text-align: left;
                width: 50%;
                font-size: 9px;
                height:30px
            }
            
            .valuebar2 {
                padding-top: 8px;
                padding-right: 15px;
                text-align: right;
                width: 50%;
                font-size: 9px;
                height:30px
            }
            
            .slidebar1 {
                padding-top: 8px;
                padding-bottom: 15px;
                height:50px;
            }
            
            #cong {
                background-color: white;
                font-size: larger;
            }
            
            .largebar {
                width: 50px;
                height: 70px;
            }
            
            .table1 {
                padding-bottom: 10px;
                width: 100%;
                min-width: 200px;
                box-sizing: 1px 10px;
                background-color: white;
                box-shadow: gray;
                margin-bottom: 30px;
                -webkit-box-shadow: 1px 0px 8px 0px rgba(50, 49, 56, 0.2);
                -moz-box-shadow: 1px 0px 8px 0px rgba(50, 49, 56, 0.2);
                box-shadow: 1px 0px 8px 0px rgba(50, 49, 56, 0.2);

            }
            
            td {
                padding-left: 25px;
                font-size: 13px;
            }
            
            .titlecolor {
                background-color: #F0846C;
                color: white;
                text-align: center;
                width: 100%;
                min-width: 200px;
                font-size: 12px;
                height:50px;
                border: none;
            }
            
            .tags {
                width: 100px;
                border: none;
                padding: 5px;
                font-size: 9px;
                height:50px;
            }

            #isnew1,
            #isnew2{
                height:40px;
            }

            
            
            .box {
                text-align: right;
                padding-right: 7px;
                height:40px;
            }
            
            #loc {
                height:50px;
                width: 100px;
                border: white;
                text-align: right;
                padding-right: 7px;
                font-size: 13px;
            }
            
            .mybutton {
                box-shadow:inset 0px 0px 10px 1px #cf866c;
                background-color:#d0451b;
                border-radius:16px;
                border:2px solid #942911;
                display:inline-block;
                align-items: center;
                cursor:pointer;
                color:#ffffff;
                font-family:Arial;
                margin-left: 100px;
                font-size:12px;
                padding:7px 30px;
                margin-top: 5px;
                text-decoration:none;
                text-shadow:0px 0px 0px #854629;
            }
            .mybutton:hover {
                background-color:#bc3315;
            }
            .mybutton:active {
                position:relative;
                top:1px;
                border: white;
            }

            .hidetb{
                float:right;
                background-image: url("./img/button_bg.svg");
                width:30px;
                height:30px;
                border: none;
                background-color: transparent;
            }



            .hidetb:active{
               outline: none;
            }

            .showtb{
                display: block;
            }
            
            /* .hiddentb{
                display: none;
            } */
           
            #loc2 {
                padding: 5px;
                text-align: center;
                
            }
            
            .inlist {
                font-size: 9px;
                text-align: center;
                margin:6px
            }
            
            .container {
                width: 90%;
            }
            
            

            #toptitle{
                font-size:25px;
                /* margin-left: 10px; */
                font-weight:900;
                text-align: initial;
            }

            body{
                margin:none;
            }

      
            #pricerange{
                display:block
            }
            @media (max-width: 940px) {
                #toptitle{
                
                text-align: center;
            }
            }
        </style>

    <div id="toptitle">篩選</div>
    <div class="panel_wrapper">

        <table class="table1">

            <tbody><tr>
                <th class="titlecolor" colspan="2">分類</th>
            </tr>
            <tr>
                <td><change-category></change-category></td>
            </tr>
            



        </tbody></table>

    <table class="table1">

            <tbody><tr>
                <th class="titlecolor" colspan="2">配件標籤
            </th></tr>
            <tr>
                <td style="
                padding: 0px;
            ">
                    <div class="address">
                        <img id="miniimg" src="./Website%20Design/listing%20page/img/symbol/listing_page-03.png">

                        <vaadin-text-field id="inputTags" on-keydown="_addTags" placeholder="請輸入標籤" style="width: 90%;"></vaadin-text-field>
                        <paper-tags-input width="100%" id="myTags" style="display:none;"></paper-tags-input>
                    </div>
                    
                </td>
                

            </tr>

        </tbody></table>
        

        <table class="table1">
            <tbody><tr>
                <th class="titlecolor">地點</th>
            </tr>
            <tr>
                <td style="
                padding: 0px;
            ">
                    <div class="address">
                        <img id="miniimg" src="./Website%20Design/listing%20page/img/symbol/location.png">
                        <change-district></change-district>
                    </div>
                    
                </td>

            </tr>
        </tbody></table>
        
        <table class="table1">
            <tbody><tr>
                <th class="titlecolor" colspan="2">商品狀況</th>
            </tr>
            <tr>
                <td>全新</td>
                <td class="box"><input type="checkbox" name="stat" id="isnew1"></td>
            </tr>
            <tr>
                <td>二手</td>
                <td class="box"><input type="checkbox" name="stat" id="isnew2"></td>

            </tr>

        </tbody></table>
        
        <div id="pricerange">

            <table class="table1">

                <tr>
                    <th class="titlecolor" colspan="2">價錢範圍</th>
                </tr>
                <tr>
                    <td><div id="renew"><change-range></change-range></div></td>

                </tr>
                
            </table>


        </div>
        <button class="titlecolor" id="searchbutt">搜尋</button></div>
    </template>
</dom-module>


<script>
    (function() {
        Polymer({
            is: 'change-slidelist',
            properties: {
                'countcate': {
                    "type": Number
                },
                'cateIdarray': {
                    "type": Array
                },
                'allIdarray': {
                    "type": Array
                },
                'storeingcate': {
                    "type": Array
                }

            },
            created: function() {
                let that = this;
            },
            _addTags(e) {
                let myTags = this.shadowRoot.querySelector('#myTags');
                let val = this.shadowRoot.querySelector('#inputTags').value;

                if (e.code === "Enter") {
                    //myTags._addTag(val);
                    Polymer.dzFire('query-tags', {
                        'detail': {
                            'tags': val
                        }
                    });
                    this.shadowRoot.querySelector('#inputTags').value = "";
                }
            },

            ready: function() {
                let that = this;
                let shadow = this.shadowRoot;
                let Url = "https://41khtanrje.execute-api.ap-northeast-1.amazonaws.com/prod/Dazzle-elasticSearchController";

                var storetags = location.search;
                turntags = []
                for (b = 0; b < storetags.length; b++) {
                    turntags.push(storetags[b])
                }
                if (turntags[1] == "c") {
                    turntags.splice(0, 5);
                    var thecate = turntags.join("").toString();

                } else if (turntags[1] == "t") {

                    turntags.splice(0, 4);
                    var thetags = turntags.join("").toString();
                    var dec = unescape(thetags);




                } else {};


                shadow.querySelector('#searchbutt').addEventListener('click', e => {
                    Polymer.dzFire('select-range', {
                        'detail': {
                            'start': shadow.querySelector('change-range').shadowRoot.querySelector('#slider-range-value1').innerHTML,
                            'end': shadow.querySelector('change-range').shadowRoot.querySelector('#slider-range-value2').innerHTML
                        }
                    })
                    var event = new CustomEvent('close-item-dialog', {});
                    document.dispatchEvent(event);
                })

                shadow.querySelector('#isnew1').addEventListener('click', e => {
                    if (shadow.querySelector('#isnew1').checked == true) {
                        Polymer.dzFire('query-isNew', {
                            'detail': {
                                'isNew': "全新"
                            }
                        })
                    } else {
                        let value = "全新";
                        let shop = document.querySelector('change-shop');
                        let papertag = document.querySelector('change-shop').shadowRoot.querySelector('paper-tags-input')._getTags();
                        document.querySelector('change-shop').shadowRoot.querySelector('paper-tags-input')._onTagItemRemove({
                            "detail": {
                                "index": papertag.indexOf(value)
                            }

                        });


                        shop.back("全新");

                    }

                });
                shadow.querySelector('#isnew2').addEventListener('click', e => {
                    if (shadow.querySelector('#isnew2').checked == true) {
                        Polymer.dzFire('query-isNew', {
                            'detail': {
                                'isNew': "二手"
                            }
                        })
                    } else {
                        let value = "二手";
                        let shop = document.querySelector('change-shop');
                        let papertag = document.querySelector('change-shop').shadowRoot.querySelector('paper-tags-input')._getTags();
                        document.querySelector('change-shop').shadowRoot.querySelector('paper-tags-input')._onTagItemRemove({
                            "detail": {
                                "index": papertag.indexOf(value)
                            }

                        });


                        shop.back("二手");

                    }
                });
                shadow.querySelector('change-range').new();

                document.addEventListener('areachange', e => {
                    let free = e.detail.isFree;
                    if (free == true) {
                        shadow.querySelector('#pricerange').style.display = "none";
                        let freecss = shadow.querySelectorAll('.titlecolor')
                        for (i = 0; i < freecss.length; i++) {
                            freecss[i].style.backgroundColor = "#4CAF50";
                        }
                    } else {
                        let freecss = shadow.querySelectorAll('.titlecolor')
                        for (i = 0; i < freecss.length; i++) {
                            freecss[i].style.backgroundColor = "#F0846C";
                        }
                        shadow.querySelector('#pricerange').style.display = "block";

                    }
                })
            },


        });
    })();
</script>