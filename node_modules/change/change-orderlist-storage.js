<<<<<<< Updated upstream
import { PolymerElement, html } from 'https://d25k6mzsu7mq5l.cloudfront.net/node_modules/@polymer/polymer/polymer-element.js';
import 'https://d25k6mzsu7mq5l.cloudfront.net/node_modules/@vaadin/vaadin-dialog/vaadin-dialog.js';
// import {Dazzle} from 'https://d25k6mzsu7mq5l.cloudfront.net/node_modules/@dazzle/dz-dazzle/dz-library.js';
import './change-order-list.js';


class dzElm extends PolymerElement {
  static get properties () {
    return {
        "id": {
            "type": String
        },
        "removeid": {
            "type": String
        },
        "orders": Array
    };
  }

  constructor() {
    super();
    let loc = location.search;
    let pid = "";
    let uid = "";
    let that = this;
    let posit = 0;
    if(window.location.hash)
        pid = window.location.hash.substring(1);
    else
        pid = document.head.querySelector('meta[name=product-id]').getAttribute('content');
    this.prodManager = new DataPackage("product");
    this.orderManager = new DataPackage("order");
  }
  ready() {
      super.ready();

      console.log("inside orderlist-storage.html");
      // html + ?xxxxxxxxxxxxxxxxx
      let that = this;
      let shadow = this.shadowRoot;
      //*****************DETERMINE TO DISPLAY ORDERLIST STORAGE OR NOT*****************//
      let user = store.get('change-user') || null;
      // shadow.querySelector('.orderContainter').style.display = 'none';
      
      //fail to select 'change-order-list'
      let k = shadow.querySelector('change-order-list');
      // console.log("order1", k);
}


isPermitted() {
    let user = store.get('change-user') || null;
    let permitted = true;
    if (!user)
        permitted = false;

    if (user.isAdmin)
        permitted = true;
    
    if (this.product['ownerId'] === user['id'])
        permitted = true;

    return permitted;
}

_clearReply(){
    let cfm = confirm('你的所有請求都會清空, 是否確認？');
    if (cfm) {
        let orders = this.querySelectorAll('change-order-list');
        orders.forEach(item=>{
            item.reject();
        });
//        Dazzle.dzFire('cancel-request',{});
    }

}
  static get template () {
    // Template getter must return an instance of HTMLTemplateElement.
    // The html helper function makes this easy.
    return html`
    <style>
            .orderContainter {
                height: auto;
                background-image: url("https://www.gettv.hk/img/background/3.jpg");
                padding-bottom: 50px;
                margin: 0 auto;
                /* display: none; */
            }

            .order {
                width: 94%;
                margin: 0 auto;
                font-size: 20px;
                color: black;
                padding-bottom: 50px;
            }

            .text {
                padding-top: 45px;
                padding-bottom: 45px;
            }

            * {
                font-family: sans-serif, Microsoft JhengHei;

            }

            .bg {
                background-color: white;
                width: 92.5%;
                margin: 0 auto;
                border: 1px #ccc solid;
            }

            @media (max-width: 758px) {
                .orderContainter {
                    padding-bottom: 120px;
                }
            }
        </style>
        <div class="orderContainter">
            <div class="bg">
            <template is="dom-if" if="{{isPermitted()}}">
<!--                <vaadin-button on-click="_clearReply" style="float:right">清空請求</vaadin-button> -->
            </template>

                <div class="order">
                    <div class="text"><b>處理訂單:</b></div>
                    <div id="ol">
                        <slot></slot>
                    </div>
                </div>
                <!-- <div id="ol"></div> -->
            </div>
        </div>


        </div>
    `;
  }
}

// Register the element with the browser.
customElements.define('change-orderlist-storage', dzElm);

=======
import { PolymerElement, html } from 'https://d25k6mzsu7mq5l.cloudfront.net/node_modules/@polymer/polymer/polymer-element.js';
import 'https://d25k6mzsu7mq5l.cloudfront.net/node_modules/@vaadin/vaadin-dialog/vaadin-dialog.js';
// import {Dazzle} from 'https://d25k6mzsu7mq5l.cloudfront.net/node_modules/@dazzle/dz-dazzle/dz-library.js';
import './change-order-list.js';


class dzElm extends PolymerElement {
  static get properties () {
    return {
        "id": {
            "type": String
        },
        "removeid": {
            "type": String
        },
        "orders": Array
    };
  }

  constructor() {
    super();
    let loc = location.search;
    let pid = "";
    let uid = "";
    let that = this;
    let posit = 0;
    if(window.location.hash)
        pid = window.location.hash.substring(1);
    else
        pid = document.head.querySelector('meta[name=product-id]').getAttribute('content');
    this.prodManager = new DataPackage("product");
    this.orderManager = new DataPackage("order");
  }
  ready() {
      super.ready();

      console.log("inside orderlist-storage.html");
      // html + ?xxxxxxxxxxxxxxxxx
      let that = this;
      let shadow = this.shadowRoot;
      //*****************DETERMINE TO DISPLAY ORDERLIST STORAGE OR NOT*****************//
      let user = store.get('change-user') || null;
      // shadow.querySelector('.orderContainter').style.display = 'none';
      
      //fail to select 'change-order-list'
      let k = shadow.querySelector('change-order-list');
      // console.log("order1", k);
}


isPermitted() {
    let user = store.get('change-user') || null;
    let permitted = true;
    if (!user)
        permitted = false;

    if (user.isAdmin)
        permitted = true;
    
    if (this.product['ownerId'] === user['id'])
        permitted = true;

    return permitted;
}

_clearReply(){
    let cfm = confirm('你的所有請求都會清空, 是否確認？');
    if (cfm) {
        let orders = this.querySelectorAll('change-order-list');
        orders.forEach(item=>{
            item.reject();
        });
//        Dazzle.dzFire('cancel-request',{});
    }

}
  static get template () {
    // Template getter must return an instance of HTMLTemplateElement.
    // The html helper function makes this easy.
    return html`
    <style>
            .orderContainter {
                height: auto;
                background-image: url("https://www.gettv.hk/img/background/3.jpg");
                padding-bottom: 50px;
                margin: 0 auto;
                /* display: none; */
            }

            .order {
                width: 94%;
                margin: 0 auto;
                font-size: 20px;
                color: black;
                padding-bottom: 50px;
            }

            .text {
                padding-top: 45px;
                padding-bottom: 45px;
            }

            * {
                font-family: sans-serif, Microsoft JhengHei;

            }

            .bg {
                background-color: white;
                width: 92.5%;
                margin: 0 auto;
                border: 1px #ccc solid;
            }

            @media (max-width: 758px) {
                .orderContainter {
                    padding-bottom: 120px;
                }
            }
        </style>
        <div class="orderContainter">
            <div class="bg">
            <template is="dom-if" if="{{isPermitted()}}">
<!--                <vaadin-button on-click="_clearReply" style="float:right">清空請求</vaadin-button> -->
            </template>

                <div class="order">
                    <div class="text"><b>處理訂單:</b></div>
                    <div id="ol">
                        <slot></slot>
                    </div>
                </div>
                <!-- <div id="ol"></div> -->
            </div>
        </div>


        </div>
    `;
  }
}

// Register the element with the browser.
customElements.define('change-orderlist-storage', dzElm);

>>>>>>> Stashed changes
